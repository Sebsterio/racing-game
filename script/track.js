

const TRACK_SIZE = 40;
const TRACK_COLS = 20;
const TRACK_ROWS = 15;	

var currentTrackIndex = 0;
var CarStartAngle;
var trackGrid = [];

const TRACK_ROAD = 0;
const TRACK_WALL = 1;
const TRACK_PLAYER = 2;
const TRACK_GOAL = 3;
const TRACK_TREE = 4;
const TRACK_FLAG = 5;
const TRACK_OIL = 6;
const TRACK_GRASS = 7;
const TRACK_RAMP = 8;

function loadTrack() {
	trackGrid = mapTemplates[currentTrackIndex][0].slice();
	CarStartAngle = mapTemplates[currentTrackIndex][1]
}

function nextTrack() {
	p1.homeX = undefined;
	p2.homeX = undefined;
	currentTrackIndex++;
	if (currentTrackIndex == mapTemplates.length) currentTrackIndex = 0;
}

function drawTracks() {
	var index = 0;
	var trackX = 0;
	var trackY = 0
	for (var row=0; row<TRACK_ROWS; row++){
		for (var col=0; col<TRACK_COLS; col++){
			ctx.drawImage(trackPics[trackGrid[index]], trackX, trackY);
			trackX += TRACK_SIZE;
			index++;
		}
		trackX = 0;
		trackY += TRACK_SIZE;
	}
};


var mapTemplates = [
// second paramenter - car start angle
	[
		[	4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,
			4,3,3,4,2,0,0,0,0,0,0,0,0,8,6,6,0,0,1,1,
			1,0,0,4,2,0,0,0,0,0,0,0,0,8,0,0,0,0,0,1,
			1,0,0,1,1,7,7,7,7,7,7,7,7,7,7,7,6,6,0,1,
			1,0,0,1,1,1,1,4,4,4,4,1,1,1,1,1,7,0,0,1,
			1,6,6,1,1,0,0,1,4,4,1,1,0,0,0,1,1,0,0,1,
			1,0,0,1,0,0,0,0,1,4,1,0,0,0,0,0,1,0,0,1,
			1,0,0,1,8,0,0,0,0,1,1,0,0,0,0,0,1,0,0,1,
			1,6,6,1,0,0,0,0,0,0,1,0,0,5,0,0,1,0,0,1,
			1,8,0,1,0,0,5,0,0,0,5,0,0,1,0,0,1,0,0,1,
			1,0,0,1,0,0,1,7,0,0,0,0,0,1,0,0,5,0,0,1,
			1,0,0,1,0,0,1,1,7,0,0,0,0,1,0,0,0,0,0,1,
			1,0,0,0,0,0,1,4,1,7,0,0,7,1,8,0,0,0,0,1,
			1,0,0,0,0,0,1,4,4,1,7,7,1,1,1,0,0,0,1,1,
			1,1,1,1,1,1,1,4,4,4,4,4,4,1,1,1,1,1,1,1
		], 0],
	[
		[	4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,
			4,1,1,0,0,0,0,0,0,0,0,0,0,0,6,6,0,0,1,1,
			1,1,0,0,0,0,0,0,0,0,8,0,0,0,0,6,6,0,0,1,
			1,0,0,0,0,7,7,7,7,7,7,7,7,7,7,7,6,6,0,1,
			1,0,0,0,1,1,1,4,4,4,4,1,1,1,1,1,7,0,0,1,
			1,6,6,1,1,0,0,1,4,4,1,1,0,0,0,1,1,0,0,1,
			1,8,0,1,0,0,0,0,1,4,1,0,0,0,0,0,1,0,0,1,
			1,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,1,0,0,1,
			1,2,2,1,0,0,0,0,0,0,1,0,0,5,0,0,1,0,0,1,
			1,0,0,1,0,0,5,0,0,0,5,0,0,1,0,0,1,0,0,1,
			1,1,1,1,0,0,1,7,0,0,0,0,0,1,0,0,5,0,0,1,
			1,1,5,1,0,0,1,1,7,0,0,0,0,1,0,0,0,0,0,1,
			0,3,0,0,0,0,1,4,1,7,0,0,7,1,0,0,0,0,0,1,
			0,3,0,0,0,0,1,4,4,1,7,7,1,1,1,0,0,0,1,1,
			1,1,5,1,1,1,1,4,4,4,4,4,4,1,1,1,1,1,1,1
		], -0.5],
	[ 
		[	4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,
			4,1,1,0,0,0,0,0,0,0,0,0,0,0,6,6,0,0,1,1,
			1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,0,0,1,
			1,0,0,0,0,7,7,7,7,7,7,7,7,7,7,7,6,6,0,1,
			1,0,0,0,1,1,1,4,4,4,4,1,1,1,1,1,7,0,0,1,
			1,6,6,1,1,0,0,1,4,4,1,1,0,0,0,1,1,0,0,1,
			1,0,0,1,0,0,0,0,1,4,1,0,0,0,0,0,1,0,0,1,
			1,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,1,0,0,1,
			1,0,0,1,0,0,0,0,0,0,1,0,0,5,0,0,1,0,0,1,
			1,0,0,1,0,0,5,0,0,0,5,0,0,1,0,0,1,0,0,1,
			1,0,0,1,0,0,1,7,0,0,0,0,0,1,0,0,1,0,0,1,
			1,0,0,1,0,0,1,1,7,0,0,0,0,1,0,0,1,0,0,1,
			1,0,0,0,0,0,1,4,1,7,0,0,7,1,0,0,1,0,0,1,
			1,0,0,0,0,0,1,4,4,1,7,7,1,1,3,3,1,2,2,1,
			1,1,5,1,1,1,1,4,4,4,4,4,4,1,1,1,1,1,1,1
		], -0.5]
];